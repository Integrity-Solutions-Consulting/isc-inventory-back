<<<<<<< HEAD:api/src/main/java/com/isc/service/impl/AppearanceServiceImpl.java
package com.isc.service.impl;

import java.time.LocalDateTime;
import java.util.List;
import java.util.stream.Collectors;

import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Service;

import com.isc.dto.request.AppearanceRequestDTO;
import com.isc.dto.response.AppearanceDetailResponseDTO;
import com.isc.dto.response.AppearanceResponseDTO;
import com.isc.dto.response.MessageResponseDTO;
import com.isc.dtos.MetadataResponseDto;
import com.isc.dtos.ResponseDto;
import com.isc.entitys.AppearanceEntity;
import com.isc.mapper.AppearanceMapper;
import com.isc.repository.AppearanceRepository;
import com.isc.service.AppearanceService;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class AppearanceServiceImpl implements AppearanceService{
	private final AppearanceRepository appearanceRepository;

    @Override
    public ResponseDto<List<AppearanceDetailResponseDTO>> getAllDetails() {
        List<AppearanceDetailResponseDTO> response = appearanceRepository.findAllByActiveTrue().stream().map(AppearanceMapper::toDetailDto).collect(Collectors.toList());
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencias listadas correctamente");
        return new ResponseDto<>(response, metadata);
=======
package com.isc.api.service.impl;
import java.time.LocalDateTime;
import java.util.List;

import org.springframework.stereotype.Service;
import com.isc.api.mapper.AppearanceMapper;
import com.isc.api.dto.request.AppearanceRequestDTO;
import com.isc.api.dto.response.AppearanceResponseDTO;
import com.isc.api.dto.response.AppearanceDetailResponseDTO;
import com.isc.api.dto.response.MessageResponseDTO;
import com.isc.dtos.MetadataResponseDto;
import com.isc.dtos.ResponseDto;
import com.isc.api.entitys.AppearanceEntity;
import com.isc.api.repository.AppearanceRepository;
import com.isc.api.service.AppearanceService;

import lombok.RequiredArgsConstructor;

import org.springframework.http.HttpStatus;

@Service
@RequiredArgsConstructor
public class AppearanceServiceImpl implements AppearanceService {

    private final AppearanceRepository repository;

    @Override
    public ResponseDto<List<AppearanceDetailResponseDTO>> getAllDetails() {
        List<AppearanceDetailResponseDTO> list = repository.findAll().stream()
            .map(AppearanceMapper::toDetailDTO)
            .toList();
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia listada con detalles correctamente");
        return new ResponseDto<>(list,metadata);
>>>>>>> 0f93e5da78987daf93e729d5c42a36786331c01f:api/src/main/java/com/isc/api/service/impl/AppearanceServiceImpl.java
    }

    @Override
    public ResponseDto<List<AppearanceResponseDTO>> getSimpleList() {
<<<<<<< HEAD:api/src/main/java/com/isc/service/impl/AppearanceServiceImpl.java
        List<AppearanceResponseDTO> response = appearanceRepository.findAllByActiveTrue().stream()
                .map(AppearanceMapper::toSimpleDto).collect(Collectors.toList());
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencias listadas correctamente");
        return new ResponseDto<>(response, metadata);
    }

    @Override
    public ResponseDto<AppearanceDetailResponseDTO> save(AppearanceRequestDTO request) {
        AppearanceEntity entity = new AppearanceEntity();
        entity = appearanceRepository.save(entity);
        AppearanceDetailResponseDTO response = AppearanceMapper.toDetailDto(entity);
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia guardada correctamente");
        return new ResponseDto<>(response, metadata);
=======
        List<AppearanceResponseDTO> list = repository.findAll().stream()
            .map(AppearanceMapper::toSimpleDTO)
            .toList();
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia listada correctamente");
        return new ResponseDto<>(list,metadata);
    }

    @Override
    public ResponseDto<AppearanceDetailResponseDTO> save(AppearanceRequestDTO dto) {
        AppearanceEntity entity = new AppearanceEntity();
        entity.setLoginBackground(dto.getLogin_background());
        entity.setTypography(dto.getTypography());
        entity.setFixedHeader(dto.getFixed_header());
        entity.setMenuPosition(dto.getMenu_position());
        entity.setCollapsedMenu(dto.getCollapsed_menu());
        entity.setBackgroundColor(dto.getBackground_color());
        entity.setBoxBorder(dto.getBox_border());
        entity.setBoxBackground(dto.getBox_background());
        entity.setActive(true);
        entity.setCreationDate(LocalDateTime.now());
        AppearanceEntity saved = repository.save(entity);
        
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia creada correctamente");
        return new ResponseDto<>(AppearanceMapper.toDetailDTO(saved), metadata);
>>>>>>> 0f93e5da78987daf93e729d5c42a36786331c01f:api/src/main/java/com/isc/api/service/impl/AppearanceServiceImpl.java
    }

    @Override
    public ResponseDto<AppearanceDetailResponseDTO> update(AppearanceRequestDTO request, Integer id) {
<<<<<<< HEAD:api/src/main/java/com/isc/service/impl/AppearanceServiceImpl.java
        AppearanceEntity entity = appearanceRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("Apariencia no encontrada con ID: " + id));
        entity.setLogin_background(request.getLogin_background());
        entity.setTypography(request.getTypography());
        entity.setFix_header(request.getFix_header());
        entity.setMenu_position(request.getMenu_position());
        entity.setCollapsed_menu(request.getCollapsed_menu());
        entity.setBackground_color(request.getBackground_color());
        entity.setBox_order(request.getBox_order());
        entity.setBox_background(request.getBox_background());
        entity.setModificationDate(LocalDateTime.now());
        entity = appearanceRepository.save(entity);
        AppearanceDetailResponseDTO response = AppearanceMapper.toDetailDto(entity);
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia actualizada correctamente");
        return new ResponseDto<>(response, metadata);
    }

    @Override
    public ResponseDto<MessageResponseDTO> inactive(Integer id) {
        int rowsAffected = appearanceRepository.inactive(id);
        if (rowsAffected == 0) {
            throw new RuntimeException("No se pudo desactivar la apariencia con ID: " + id);
        }
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia desactivada correctamente");
        MessageResponseDTO message = new MessageResponseDTO("Apariencia desactivada correctamente");
        return new ResponseDto<>(message, metadata);
    }

    @Override
    public ResponseDto<MessageResponseDTO> active(Integer id) {
        int rowsAffected = appearanceRepository.active(id);
        if (rowsAffected == 0) {
            throw new RuntimeException("No se pudo activar la apariencia con ID: " + id);
        }
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia activada correctamente");
        MessageResponseDTO message = new MessageResponseDTO("Apariencia activada correctamente");
        return new ResponseDto<>(message, metadata);
    }
	
=======
        AppearanceEntity entity = repository.findById(id)
            .orElseThrow(() -> new RuntimeException("Apariencia no encontrada"));
        
        entity.setLoginBackground(request.getLogin_background());
        entity.setTypography(request.getTypography());
        entity.setFixedHeader(request.getFixed_header());
        entity.setMenuPosition(request.getMenu_position());
        entity.setCollapsedMenu(request.getCollapsed_menu());
        entity.setBackgroundColor(request.getBackground_color());
        entity.setBoxBorder(request.getBox_border());
        entity.setBoxBackground(request.getBox_background());
        entity.setModificationDate(LocalDateTime.now());
        AppearanceEntity updated = repository.save(entity);
        
        MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia actualizada");
        return new ResponseDto<>(AppearanceMapper.toDetailDTO(updated),metadata);
    }

    @Override
	public ResponseDto<MessageResponseDTO> inactive(Integer id) {
		int rowsAffected = repository.inactive(id);
		if(rowsAffected == 0) {
			 throw new RuntimeException("No se pudo realizar la operacion en el id: " + id);
		}
	    MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia desactivada");
		MessageResponseDTO message = new MessageResponseDTO("Operacion exitosa");
		return new ResponseDto<>(message, metadata);
	}

    @Override
	public ResponseDto<MessageResponseDTO> active(Integer id) {
		int rowsAffected = repository.active(id);
		if(rowsAffected == 0) {
			 throw new RuntimeException("No se pudo realizar la operacion en el id: " + id);
		}
	    MetadataResponseDto metadata = new MetadataResponseDto(HttpStatus.OK, "Apariencia activada");
		MessageResponseDTO message = new MessageResponseDTO("Operacion exitosa");
		return new ResponseDto<>(message, metadata);
	}
>>>>>>> 0f93e5da78987daf93e729d5c42a36786331c01f:api/src/main/java/com/isc/api/service/impl/AppearanceServiceImpl.java
}
